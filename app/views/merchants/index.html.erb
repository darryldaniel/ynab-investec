<div class="flex-col" data-controller="merchant">
    <h1 class="text-xl mb-5">Map Merchants</h1>
    <% @merchants.each do |merchant| %>
        <%= turbo_frame_tag dom_id(merchant) do %>
            <%= form_with url: update_ynab_mapping_merchants_path, method: :patch do |form| %>
                <div  class="flex flex-col items-start rounded overflow-hidden p-5 mb-4 shadow-lg">
                    <h2 class="font-bold text-xl mb-6"><%= merchant.name %></h2>
                    <%= form.hidden_field :merchant_id, value: merchant.id %>
                    <%= form.select :payee,
                                    @ynab_payees.map { |payee| [payee.name, payee.id] },
                                    {
                                        include_blank: "Choose payee"
                                    },
                                    {
                                        data: {
                                            merchant_target: "payeeSelect"
                                        },
                                    }
                    %>
                    <div class="my-4">
                        <%= form.check_box :exclude %>
                        <%= form.label :exclude, "Exclude" %>
                    </div>

                    <%= form.submit "Update",
                                    data: { turbo_submits_with: "Updating..." },
                                    class: "bg-transparent hover:bg-gray-600 text-gray-700 font-semibold hover:text-white py-2 px-4 border border-gray-500 hover:border-transparent rounded" %>
                </div>
            <% end %>
        <% end %>
    <% end %>
</div>
